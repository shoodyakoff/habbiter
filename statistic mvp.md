# Техническое задание: Статистика MVP (Обратная матрица)

## Задача: Реализация "Обратной матрицы" на странице Статистики

### Описание
Реализовать визуализацию пропусков привычек ("Обратная матрица") на уже существующей странице `/stats`. Мы идем от обратного: чистое поле — это успех, наличие точек — это пропуски (failures).

---

### Текущее состояние проекта
- **Страница:** `src/app/stats/page.tsx` (существует, сейчас заглушка).
- **Навигация:** Таб "Статистика" уже есть в `BottomNav`.
- **Компоненты:** `WeekSwitcher` реализован в `src/features/habits/components/WeekSwitcher.tsx` (можно переиспользовать или адаптировать логику).
- **Данные:**
  - `useHabitsQuery` — получение списка привычек.
  - `useWeekRecordsQuery(dates[])` — получение записей выполнения за массив дат.

---

### Требования к реализации

#### 1. Управление периодом (Неделя)
- **Расположение:** Верхняя часть страницы `src/app/stats/page.tsx`.
- **Функционал:**
  - Переключение недель (назад/вперед).
  - Отображение текущего периода (например, "24 Фев - 2 Мар").
  - По умолчанию: текущая неделя.
- **Реализация:**
  - Использовать логику из `WeekSwitcher` или вынести `WeekSwitcher` в общий компонент, если он слишком привязан к главной странице, либо создать упрощенный контрол для статистики.

#### 2. Визуализация: Матрица пропусков (Inverse Matrix)
**Техническая реализация:** CSS Grid (Tailwind).

**Структура сетки:**
- **Ось Y (Вертикаль) — Привычки:**
  - Список активных привычек.
  - Отображение: Иконка (в цвете привычки) + Название (truncate).
  
- **Ось X (Горизонталь) — Дни недели:**
  - 7 колонок (Пн..Вс).
  - Заголовки: День недели + Число.

- **Ячейки (Пересечение):**
  - **Логика отображения (Приоритет сверху вниз):**
    1. **Будущий день** (`date > today`): Пустота.
    2. **Сегодняшний день** (`date == today`): Пустота (даем шанс выполнить).
    3. **Прошедший день** (`date < today`):
       - Привычка **Выполнена**: Пустота (Clean = Success).
       - Привычка **НЕ Выполнена**: **Точка** (Dot).

- **Стиль точки:**
  - Цвет: `bg-destructive` (или черный/белый в зависимости от темы, но лучше семантический цвет ошибки/пропуска).
  - Размер: `size-2` или `size-3`, `rounded-full`.
  - Расположение: Центр ячейки.

#### 3. Состояния
- **Загрузка:** Скелетон сетки.
- **Пустое состояние:** "Нет привычек для отображения".

### План работ
1.  В `src/app/stats/page.tsx`:
    - Подключить `useHabitsQuery`.
    - Реализовать стейт для выбранной даты/недели (аналогично `WeekSwitcher`).
    - Вычислить массив дат недели.
    - Подключить `useWeekRecordsQuery(weekDates)`.
2.  Сверстать грид:
    - Левая колонка: список привычек.
    - Основная часть: 7 колонок дней.
3.  Реализовать логику рендеринга точек (проверка наличия записи в `records` для конкретной `habitId` и `date`).

---

### Критерии приемки
- [ ] На странице `/stats` отображается список привычек.
- [ ] Сверху есть переключатель недель.
- [ ] Для прошедших дней, где привычка не выполнена, отображается точка.
- [ ] Для выполненных привычек ячейка пустая.
- [ ] Будущие дни пустые.
